{% extends '@SyliusShop/shared/layout/base.html.twig' %}

{% set prefixes = ['sylius_shop.cart'] %}

{% block title %}{{ 'sylius.ui.your_shopping_cart'|trans }} | {{ parent() }}{% endblock %}

{% block content %}
    {% hook 'index' with { _prefixes: prefixes, cart, form } %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const quantityInputs = document.querySelectorAll('input[name^="sylius_shop_cart[items]["][name$="[quantity]"]');
            quantityInputs.forEach((quantityInput) => {
                quantityInput.setAttribute('step', '10');
                quantityInput.setAttribute('min', '10');
                quantityInput.dispatchEvent(new Event('input'));

                quantityInput.addEventListener('input', function(){
                    let quantity = parseInt(quantityInput.value, 10);
                    if (quantity === 70) {
                        setTimeout(function () {
                            alert('Great Choice!');
                        }, 100);
                    }
                });

                quantityInput.addEventListener('change', function(){
                    let quantity = parseInt(quantityInput.value, 10);
                    if (quantity % 10 !== 0) {
                        quantity = Math.ceil(quantity / 10) * 10;
                        quantityInput.value = quantity;
                        quantityInput.dispatchEvent(new Event('input'));
                    }
                });
            });
        });
    </script>
{% endblock %}